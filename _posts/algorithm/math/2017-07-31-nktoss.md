---
title: NKTOSS
author: itsjustwinds
date: 2017-07-31T09:27:09.086Z
thumbnail: /img/uploads/images (1).jpg
tags:
  - MATH
  - DP
---
**link đề:**http://vn.spoj.com/problems/NKTOSS/

gọi 0 là sắp, 1 là ngửa

tại đây, gọi F\[i\] là số cách phù hợp cho đoạn gồm i đồng xu ngửa độ dài ít nhất là k, ở đây tự quy ước dãy mới tạo sẽ là có từ i-k đến i đều là 1.

từ 1->k-1 f\[i\]=0

f\[k\]=1;

giả sử ta muốn tính F\[i\], từ F\[i-1\], từ số dãy thỏa mãn độ dài i-1, ta có số trường hợp thỏa mãn độ dài i là F\[i-1\]\*2 vì tiếp theo sẽ là 0 hoặc 1

bắt đầu vào việc sinh dãy mới, ta sẽ coi dãy mới có từ i-k đến i đều là 1, vậy số dãy mới tạo ra là 2^(i-k-1).

tuy nhiên, 1 rắc rối là việc trùng dãy dc tạo thành từ trước, nhưng nó cũng là dãy được tạo thành F\[i-k-1\]. vậy ta chỉ việc - F\[i-k-1\] đi thì vạn sự như ý hihi.

vậy công thức tổng lại là:

**F\[i\]=F\[i-1\]\*2\+2^(i-k-1)-F\[i-k-1\]**

vì kết quả là 1 số khá lớn nên cài thêm bignum nhé .

chúc các bạn may mắn :P

**bug? **

code: http://adf.ly/1ne62D
